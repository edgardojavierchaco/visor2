{% extends 'dashboard/bodydirector.html' %}

{% load static %}

{% block content %}

<head>
    <meta charset="utf-8">
    <title>Resultados de consulta</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.css">
    <script type="text/javascript" charset="utf8" src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.js"></script>
    <style>
        .card {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    
    <h3 class="text-center">Cueanexo: <span id="cueanexo"></span> {{user.username}} - {{resultados.0.nom_est}}</h3>
    <h5 class="text-left" style="color:red">* Fuente: Relevamiento Anual 2.024</h5>
    {% if resultados %}
        <div class="container">
            <div class="row">
                <div class="col-lg-6">
                    <!-- Card para los datos del Responsable -->
                    <div class="card">
                        <div class="card-header bg-primary text-white">
                            <h5 class="card-title">Datos del Directivo</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table">
                                    <tbody>
                                        {% if resultados %}
                                            <tr>
                                                <td>Apellido y Nombre:</td>
                                                <td>{{ resultados.0.apellido_resp }} {{ resultados.0.nombre_resp }}</td>
                                            </tr>                                   
                                            
                                            <tr>
                                                <td>Email:</td>
                                                <td>
                                                    {{ resultados.0.resploc_email }}
                                                    <a href="mailto:{{ resultados.0.resploc_email }}" target="_blank">
                                                        <img src="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/icons/envelope-fill.svg" alt="Correo" width="20" height="20">
                                                    </a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Teléfono:</td>
                                                <td>
                                                    {{ resultados.0.resploc_telefono }}
                                                    <a href="https://web.whatsapp.com/send?phone={{ resultados.0.resploc_telefono }}" target="_blank">
                                                        <img src="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/icons/whatsapp.svg" alt="WhatsApp" width="20" height="20">
                                                    </a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Categoría:</td>
                                                <td>
                                                    {{ resultados.0.categoria}}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Categoría:</td>
                                                <td>
                                                    {{ resultados.0.jornada}}
                                                </td>
                                            </tr>
                                        {% endif %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <!-- Card para los datos del Supervisor Técnico -->
                    <div class="card">
                        <div class="card-header bg-success text-white">
                            <h5 class="card-title">Datos del Supervisor Técnico</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table">
                                    <tbody>
                                        {% if resultados %}
                                            <tr>
                                                <td>Apellido y Nombre:</td>
                                                <td>{{ resultados.0.sup_tecnico }}</td>
                                            </tr>
                                            <tr>
                                                <td>Email:</td>
                                                <td>
                                                    {{ resultados.0.email_suptecnico }}
                                                    <a href="mailto:{{ resultados.0.resploc_email }}" target="_blank">
                                                        <img src="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/icons/envelope-fill.svg" alt="Correo" width="20" height="20">
                                                    </a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Teléfono:</td>
                                                <td>
                                                    {{ resultados.0.tel_suptecnico }}
                                                    <a href="https://web.whatsapp.com/send?phone={{ resultados.0.resploc_telefono }}" target="_blank">
                                                        <img src="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/icons/whatsapp.svg" alt="WhatsApp" width="20" height="20">
                                                    </a>
                                                </td>
                                            </tr>
                                        {% endif %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <!-- Card para las ofertas -->
                    <div class="card">
                        <div class="card-header bg-gradient-indigo text-white">
                            <h5 class="card-title">Ofertas</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table">
                                    <tbody>
                                        {% for resultado in resultados3 %}
                                        <tr>
                                            <td>Oferta:</td>
                                            <td>{{ resultado.oferta }}</td>
                                        </tr>                                       
                                        
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <!-- Card para los títulos y orientaciones -->
                    <div class="card">
                        <div class="card-header bg-info text-white">
                            <h5 class="card-title">Títulos y Orientaciones</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table">
                                    <tbody>
                                        {% for resultado in resultados1 %}
                                        <tr>
                                            <td>Título:</td>
                                            <td>{{ resultado.titulo }}</td>
                                        </tr>
                                        <tr>
                                            <td>Orientación:</td>
                                            <td>{{ resultado.orientacion }}</td>                                        </tr>
                                        
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <!-- Card para las sedes y anexos -->
                    <div class="card">
                        <div class="card-header bg-warning text-white">
                            <h5 class="card-title">Institucional</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table">
                                    <tbody>
                                        {% for resultado in resultados2 %}
                                        <tr>
                                            <td>Anexo:</td>
                                            <td>{{ resultado.anexo }}</td>
                                        </tr>
                                        <tr>
                                            <td>Calle:</td> <td>{{ resultado.calle }}</td> <td>Número:</td><td>{{ resultado.numero }}</td>
                                             
                                        </tr>                                
                                                                               
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
        
    {% else %}
        <p class="text-center">No se encontraron resultados para el usuario</p>
    {% endif %}

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script>
        // Obtener el valor de cueanexo de la URL
        const urlParams = new URLSearchParams(window.location.search);
        const cueanexo = urlParams.get('cueanexo');
    
        // Mostrar el número de cueanexo en el título
        document.getElementById('cueanexo').textContent = cueanexo;
    </script>
    <script>
        console.log("Resultados:", {{ resultados }});
        console.log("Resultados1:", {{ resultados1 }});
        console.log("Resultados2:", {{ resultados2 }});
        console.log("Resultados3:", {{ resultados3 }});
        
    </script>

</body>
{% endblock %}
