{% load static %}
{% load widget_tweaks %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="{% static 'lib/sweetalert2/sweetalert2.all.min.js' %}"></script>
    <style>
        *{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            text-decoration: none;
            font-family: sans-serif;
        }

        main{
            width: 100%;
            padding: 20px;
            margin: auto;
            margin-top: 100px;
        }

        body {
                    background-image: url("{% static 'img/bg4.jpg' %}");
                    background-size: cover;
                    background-repeat: no-repeat;
                    background-position: center;
                }
                
        .contenedor__todo{
            width: 100%;
            max-width: 800px;
            margin: auto;
            position: relative;
        }

        .caja__trasera{
            width: 100%;
            padding: 10px 20px;
            display: flex;
            justify-content: center;
            backdrop-filter: blur(10px);
            background-color: rgba(0,128,255,0.5);
        }

        .caja__trasera div{
            margin: 100px 40px;
            color: white;
            transition: all 500ms;
        }

        .caja__trasera div p.caja__trasera button{
            margin-top: 30px;
        }

        .caja__trasera div h3{
            font-weight: 400;
            font-size: 26px;
        }

        .caja__trasera div p{
            font-size: 16px;
            font-weight: 300;
        }

        .caja__trasera button{
            padding: 10px 40px;
            border: 2px solid #fff;
            background: transparent;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            color: white;
            outline: none;
            transition: all 300ms;
        }

        .caja__trasera button:hover{
            background: white;
            color: #46a2fd;
        }

        /* Formularios */
        .contenedor__login-register{
            display: flex;
            align-items: center;
            width: 100%;
            max-width: 380px;
            position: relative;
            top: -185px;
            left: 10px;

            /* La transición va después del código JS */
            transition: left 500ms cubic-bezier(0.175, 0.885, 0.320, 1.275);
        }

        .contenedor__login-register form{
            width: 100%;
            padding: 80px 20px;
            background: #fff;
            position: absolute;
            border-radius: 20px;
        }

        .contenedor__login-register form h2{
            font-size: 30px;
            text-align: center;
            margin-bottom: 20px;
            color: #46a2fd;
        }

        .contenedor__login-register form input{
            width: 100%;
            margin-top: 20px;
            padding: 10px;
            border: none;
            background: #f2f2f2;
            font-size: 16px;
            outline: none;    
        }

        .contenedor__login-register form button{
            padding: 10px 40px;
            margin-top: 40px;
            border: none;
            font-size: 14px;
            background: #46a2fd;
            color: white;
            cursor: pointer;
            outline: none;
        }

        .formulario__login{
            opacity: 1;
            display: block;
        }

        .formulario__register{
            display: none;
        }

        /* Diseño responsivo */
        @media screen and (max-width: 850px){
            main{
                margin-top: 50px;
            }
            .caja__trasera{
                max-width: 350px;
                height: 300px;
                flex-direction: column;
                margin: auto;
            }
            .caja__trasera div{
                margin: 30px;
                position: absolute;
            }

            /* Formulario */
            .contenedor__login-register{
                top: -10px;
                left: -5px;
                margin: auto;
            }

            .contenedor__login-register form{
                position: relative;
            }
        }
    </style>
</head>
<body>
    <main>
        <div class="contenedor__todo">
            <div class="caja__trasera">
                <div class="caja__trasera-login">
                    <h3>¿Ya tienes una cuenta?</h3>
                    <p>Inicia sesión para entrar</p>
                    <button id="btn__iniciar_sesion"><i class="fas fa-sign-in-alt" style="color:green"></i> Iniciar Sesión</button>
                </div>
                <div class="caja__trasera-register">
                    <h3>¿Aún no tienes una cuenta?</h3>
                    <p>Regístrate</p>
                    <button id="btn__registrarse"><i class="fas fa-sign-out-alt" style="color:red"></i> Registrarse</button>
                </div>
            </div>

            <div class="contenedor__login-register">
                <!-- Login -->
                <form action="{% url 'logueo:login' %}" class="formulario__login" method="post">
                    {% csrf_token %}
                    <h2>Iniciar Sesión</h2>
                    {{ form }}
                    <button type="submit"><i class="fas fa-sign-in-alt" style="color:green"></i> Entrar</button>
                </form>

                <!-- Registro -->
                <form action="{% url 'usuarios:registro' %}" class="formulario__register" method="post">
                    {% csrf_token %}
                    <h2>Registrarse</h2>
                    {{ form }}
                    <button type="submit"><i class="fas fa-sign-in-alt" style="color:green"></i> Registrarse</button>
                </form>
            </div>
        </div>

        <script type="application/javascript">
            // Botón para mostrar el formulario de registro
            document.getElementById('btn__registrarse').addEventListener('click', function() {
                document.querySelector('.formulario__login').style.display = 'none';
                document.querySelector('.formulario__register').style.display = 'block';
            });

            // Botón para mostrar el formulario de inicio de sesión
            document.getElementById('btn__iniciar_sesion').addEventListener('click', function() {
                document.querySelector('.formulario__login').style.display = 'block';
                document.querySelector('.formulario__register').style.display = 'none';
            });

            {% if form.errors %}
                var errors = '';
                {% for field in form %}
                    {% for error in field.errors %}
                        errors += '{{ error }}\n';
                    {% endfor %}
                {% endfor %}
                Swal.fire({
                    title: 'Error!',
                    text: errors,
                    icon: 'error'
                });
            {% endif %}
        </script>
    </main>
</body>
</html>
